<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å±¥æ­·è¡¨</title>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-F6J23JHR93"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-F6J23JHR93');
  </script>

  <!-- å…±ç”¨æ¨£å¼ -->
  <link rel="stylesheet" href="./styles/base.css">
  <link rel="stylesheet" href="./styles/navigation.css">
  <link rel="stylesheet" href="./styles/login-screen.css">

  <!-- å°ˆå±¬æ¨£å¼ -->
  <link rel="stylesheet" href="./styles/resume.css">
</head>

<body>
  <!-- ç™»å…¥ç•«é¢ -->
  <div id="loginScreen" class="hidden"></div>

  <!-- å°è¦½åˆ— -->
  <nav id="navigation"></nav>

  <!-- ä¸»å…§å®¹å€åŸŸ -->
  <main id="resume-container">
    <!-- è¼‰å…¥å’ŒéŒ¯èª¤æç¤º -->
    <div id="loading-error-container"></div>

    <!-- å€‹äººè³‡è¨Šå€å¡Š -->
    <section class="profile-section">
      <h2 id="resume-title">å±¥æ­·è¡¨</h2>
      <h3 id="profile-subtitle">å€‹äººè³‡è¨Š</h3>
      <ul class="profile-info-list" id="profile-list">
        <!-- å°‡ç”± JavaScript å‹•æ…‹å¡«å…… -->
      </ul>
    </section>

    <!-- æ•™è‚²èƒŒæ™¯å€å¡Š -->
    <section class="education-section">
      <h3 id="education-subtitle">æ•™è‚²èƒŒæ™¯</h3>
      <ul class="education-list" id="education-list">
        <!-- å°‡ç”± JavaScript å‹•æ…‹å¡«å…… -->
      </ul>
    </section>

    <!-- å·¥ä½œç¶“æ­·å€å¡Š -->
    <section class="work-experience-section">
      <h3 id="work-experience-subtitle">å·¥ä½œç¶“æ­·</h3>
      <ul class="work-experience-list" id="work-experience-list">
        <!-- å°‡ç”± JavaScript å‹•ä½œå¡«å…… -->
      </ul>
    </section>

    <!-- å°ˆæ¥­æŠ€èƒ½å€å¡Š -->
    <section class="skills-section">
      <h3 id="skills-subtitle">å°ˆæ¥­æŠ€èƒ½</h3>
      <ul class="skills-list" id="skills-list">
        <!-- å°‡ç”± JavaScript å‹•æ…‹å¡«å…… -->
      </ul>
    </section>
  </main>

  <!-- é è…³ -->
  <footer>
    <p>Â© 2025 å±¥æ­·ç³»çµ±. ç‰ˆæœ¬ 1.0</p>
    <p><a href="index.html">è¿”å›é¦–é </a> | <a href="work-experience.html">æª¢è¦–å·¥ä½œç¶“æ­·</a></p>
  </footer>

  <!-- åˆå§‹åŒ–è…³æœ¬ -->
  <script type="module">
    import { ResumeService } from './services/ResumeService.js';
    import { LanguageManager } from './i18n/LanguageManager.js';
    import { BackToTopButton } from './components/BackToTopButton.js';

    const PAGE_TYPE = 'resume';

    // å…±ç”¨ GA æ¨™è¨˜æ–¹æ³•
    window.tagGAEvent = function tagGAEvent(name, type) {
      if (typeof gtag !== 'function') return;
      const safeName = (name || '').trim() || 'unknown';
      const pageType = type || PAGE_TYPE;
      gtag('event', 'click', {
        event_category: `${safeName}-${pageType}`,
        event_label: `${safeName}-${pageType}`,
        value: 1,
        transport_type: 'beacon'
      });
    };

    function bindLinkTracking(pageType = PAGE_TYPE) {
      document.addEventListener('click', (event) => {
        const link = event.target.closest('a');
        if (!link) return;

        const text = (link.textContent || link.getAttribute('aria-label') || link.href || '').trim();
        const name = text || link.href || 'unknown-link';
        window.tagGAEvent(name, pageType);
      });
    }

    /**
     * åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
     */
    async function initializeApp() {
      console.log('ğŸš€ åˆå§‹åŒ–å±¥æ­·é é¢...');

      try {
        // 1. åˆå§‹åŒ–èªè¨€ç®¡ç†å™¨ï¼ˆè‡ªå‹•å¾ URL æˆ– localStorage è®€å–ï¼‰
        const language = LanguageManager.initialize();
        console.log(`ğŸ“ æª¢æ¸¬åˆ°èªè¨€: ${language}`);


        // 2. åˆå§‹åŒ–æ‡‰ç”¨ç‹€æ…‹å’ŒåŠ è¼‰è³‡æ–™
        await ResumeService.initializeApp(language);

        // åˆå§‹åŒ–å›åˆ°æœ€ä¸Šæ–¹æŒ‰éˆ•
        BackToTopButton.initialize();

        // 3. å»ºç«‹é é¢æ‡‰ç”¨å¯¦ä¾‹ä¸¦æ¸²æŸ“
        const ResumeApp = (await import('./components/ResumeApp.js')).default;
        const app = new ResumeApp();
        app.renderPage();
      } catch (error) {
        console.error('âŒ æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å¤±æ•—:', error);
        const errorContainer = document.getElementById('loading-error-container');
        if (errorContainer) {
          errorContainer.innerHTML = `
            <div style="background-color: #f8d7da; color: #721c24; padding: 1rem; border-radius: 4px; margin: 1rem;">
              <strong>âŒ æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å¤±æ•—</strong>
              <p>${error.message}</p>
            </div>
          `;
        }
      }
    }

    // ç¶å®šå…¨ç«™é€£çµé»æ“Šè¿½è¹¤
    bindLinkTracking();

    // DOMContentLoaded æ™‚åˆå§‹åŒ–æ‡‰ç”¨
    document.addEventListener('DOMContentLoaded', initializeApp);
  </script>
</body>

</html>
